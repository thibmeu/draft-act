<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Privacy Pass Issuance Protocol for Anonymous Credit Tokens</title>
<meta content="Samuel Schlesinger" name="author">
<meta content="Thibault Meunier" name="author">
<meta content="
       This document specifies the issuance and redemption protocols for
tokens based on the Anonymous Credit Tokens (ACT) protocol. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="draft-schlesinger-privacypass-act-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.5.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-schlesinger-privacypass-act.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Privacy Pass Issuance Protocol for ACT</td>
<td class="right">October 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Schlesinger &amp; Meunier</td>
<td class="center">Expires 23 April 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-schlesinger-privacypass-act-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-10-20" class="published">20 October 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-04-23">23 April 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Schlesinger</div>
<div class="org">Google</div>
</div>
<div class="author">
      <div class="author-name">T. Meunier</div>
<div class="org">Cloudflare Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Privacy Pass Issuance Protocol for Anonymous Credit Tokens</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies the issuance and redemption protocols for
tokens based on the Anonymous Credit Tokens (ACT) protocol.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://SamuelSchlesinger.github.io/draft-act/draft-schlesinger-privacypass-act.html">https://SamuelSchlesinger.github.io/draft-act/draft-schlesinger-privacypass-act.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-schlesinger-privacypass-act/">https://datatracker.ietf.org/doc/draft-schlesinger-privacypass-act/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        PRIVACYPASS Privacy Pass mailing list (<span><a href="mailto:privacypass@ietf.org">mailto:privacypass@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/privacy-pass">https://mailarchive.ietf.org/arch/browse/privacy-pass</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/privacypass/">https://www.ietf.org/mailman/listinfo/privacypass/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/SamuelSchlesinger/draft-act">https://github.com/SamuelSchlesinger/draft-act</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 23 April 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-motivation" class="internal xref">Motivation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-client-state-management" class="internal xref">Client State Management</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-credential-lifecycle-and-di" class="internal xref">Credential Lifecycle and Distributed Transactions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-client-state-transitions" class="internal xref">Client State Transitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-concurrency-control-through" class="internal xref">Concurrency Control Through Blocking</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-multiple-credential-managem" class="internal xref">Multiple Credential Management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-error-handling" class="internal xref">Error Handling</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1">
                    <p id="section-toc.1-1.5.2.5.2.1.1"><a href="#section-5.5.1" class="auto internal xref">5.5.1</a>.  <a href="#name-delayed-or-missing-refunds" class="internal xref">Delayed or Missing Refunds</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-configuration" class="internal xref">Configuration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-request-context-extension" class="internal xref">Request Context Extension</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-token-challenge-requirement" class="internal xref">Token Challenge Requirements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-credential-issuance-protoco" class="internal xref">Credential Issuance Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-client-to-issuer-request" class="internal xref">Client-to-Issuer Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-issuer-to-client-response" class="internal xref">Issuer-to-Client Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-credential-finalization" class="internal xref">Credential Finalization</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-token-redemption-protocol" class="internal xref">Token Redemption Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-token-creation" class="internal xref">Token Creation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-token-refund" class="internal xref">Token Refund</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-new-credential-from-refund" class="internal xref">New Credential from Refund</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-privacy-properties" class="internal xref">Privacy Properties</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-double-spend-prevention" class="internal xref">Double-Spend Prevention</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-concurrency-control-and-cre" class="internal xref">Concurrency Control and Credential Sharing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-issuer-key-identification" class="internal xref">Issuer Key Identification</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="auto internal xref">10.5</a>.  <a href="#name-dynamic-revocation-and-orig" class="internal xref">Dynamic Revocation and Origin Control</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1"><span>[<a href="#ARCHITECTURE" class="cite xref">ARCHITECTURE</a>]</span> describes the Privacy Pass architecture, and <span>[<a href="#ISSUANCE" class="cite xref">ISSUANCE</a>]</span> and
<span>[<a href="#AUTHSCHEME" class="cite xref">AUTHSCHEME</a>]</span> describe the issuance and redemption protocols for basic Privacy
Pass tokens, i.e., those computed using blind RSA signatures as specified in
<span><a href="https://rfc-editor.org/rfc/rfc9578#section-6" class="relref">Section 6</a> of [<a href="#ISSUANCE" class="cite xref">ISSUANCE</a>]</span> or verifiable oblivious pseudorandom functions as specified in <span><a href="https://rfc-editor.org/rfc/rfc9578#section-5" class="relref">Section 5</a> of [<a href="#ISSUANCE" class="cite xref">ISSUANCE</a>]</span>. Further, the <span>[<a href="#ARC" class="cite xref">ARC</a>]</span> scheme and its associated integration in <span>[<a href="#ARCHITECTURE" class="cite xref">ARCHITECTURE</a>]</span> (<span>[<a href="#ARC_PP" class="cite xref">ARC_PP</a>]</span>) extend these approaches to multi-use
tokens.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The Anonymous Credit Tokens (ACT) protocol, as specified in <span>[<a href="#ACT" class="cite xref">ACT</a>]</span>, offers a
differentiated approach to rate limiting from <span>[<a href="#ARC" class="cite xref">ARC</a>]</span>. In particular,
a credential initially holding N credits, along with its subsequent refunded credentials,
can be presented up to N times. When a client spends a certain number of credits from
a credential, that credential is invalidated and the client receives a new credential
with the remaining balance.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document specifies the issuance and redemption protocols for ACT. <a href="#motivation" class="auto internal xref">Section 2</a>
describes motivation for this new type of token, <a href="#overview" class="auto internal xref">Section 4</a> presents an overview
of the protocols, and the remainder of the document specifies the protocols themselves.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="motivation">
<section id="section-2">
      <h2 id="name-motivation">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-motivation" class="section-name selfRef">Motivation</a>
      </h2>
<p id="section-2-1">To demonstrate how ACT is useful, one can use a similar example to
the one presented in <span><a href="https://datatracker.ietf.org/doc/html/draft-yun-cfrg-arc-01#section-2" class="relref">Section 2</a> of [<a href="#ARC_PP" class="cite xref">ARC_PP</a>]</span>: a client that wishes to keep its IP address private while accessing a service. <span>[<a href="#ARC_PP" class="cite xref">ARC_PP</a>]</span> offers the origin to limit the number of requests a client can make to N. This is enforced by each origin getting its own presentation context, and limiting the number of presentations per context to N. This means that, from a single credential, a client
can produce N presentations and access the system N times,
unlinkably. These presentations can be generated in parallel.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">On the other hand, consider a credential initially holding N credits. A client redeeming
all N credits individually has to spend <code>1</code>, receive a refunded credential with N-1 credits,
spend <code>1</code> from that credential, receive a refunded credential with N-2 credits, and so on.
Because the client cannot spend from a credential until they receive the refunded credential
from their previous spend, a single live session is enforced per initial credential.
This provides concurrency control. A client is also able to spend more than <code>1</code> credit at once,
allowing for more efficient redemption of multiple credits.
Finally, as each new presentation requires obtaining a refunded credential from the previous spend,
the origin gains the ability to invalidate a session by declining to issue a refunded credential.
This creates the
ability to shed harmful future traffic or redirect it in a favorable way.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">One such use case for this is a privacy proxy, another is privately accessing
web APIs like the artificial intelligence models, and finally zero trust networks
which act as forward proxies for their user traffic.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">Therefore, ACT provides the following properties:<a href="#section-2-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2-5">
<li id="section-2-5.1">
          <p id="section-2-5.1.1">Concurrency control: Preventing multiple simultaneous uses of the same
credential, mitigating abuse from credential sharing or replay.<a href="#section-2-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-2-5.2">
          <p id="section-2-5.2.1">Dynamic Revocation: Enabling immediate invalidation of credentials in response to
origin policy, without waiting for credential expiry.<a href="#section-2-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-2-5.3">
          <p id="section-2-5.3.1">Per-Session Rate Limiting: Enforcing access policies that adapt to user,
device, or risk context, rather than static per-credential limits. This creates incentives
for platforms to deploy such methods.<a href="#section-2-5.3.1" class="pilcrow">¶</a></p>
</li>
      </ol>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-3-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">This document uses the terms Origin, Client, Issuer, and Token as defined in
<span><a href="https://rfc-editor.org/rfc/rfc9576#section-2" class="relref">Section 2</a> of [<a href="#ARCHITECTURE" class="cite xref">ARCHITECTURE</a>]</span>. Moreover, the following additional terms are
used throughout this document.<a href="#section-3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-3.1">
          <p id="section-3-3.1.1">Issuer Public Key: The public key (from a private-public key pair) used by
the Issuer for issuing and verifying Tokens.<a href="#section-3-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-3.2">
          <p id="section-3-3.2.1">Issuer Private Key: The private key (from a private-public key pair) used by
the Issuer for issuing and verifying Tokens.<a href="#section-3-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-4">OPEN ISSUE: Consider taking them from <span>[<a href="#ACT" class="cite xref">ACT</a>]</span><a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">Unless otherwise specified, this document encodes protocol messages in TLS
notation from <span><a href="https://rfc-editor.org/rfc/rfc8446#section-3" class="relref">Section 3</a> of [<a href="#TLS13" class="cite xref">TLS13</a>]</span>. Moreover, all constants are in
network byte order.<a href="#section-3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-4">
      <h2 id="name-protocol-overview">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-4-1">The issuance and redemption protocols defined in this document are built on
the Anonymous Credit Tokens (ACT) protocol. ACT credentials can be thought of as
single use credentials, similar to the RSA Blind Signatures protocol. However,
by another viewpoint, they might be thought of as stateful, multi-use credentials.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">With ACT, Clients receive TokenChallenge inputs from the redemption protocol
(<span>[<a href="#AUTHSCHEME" class="cite xref">AUTHSCHEME</a>], <a href="https://rfc-editor.org/rfc/rfc9577#section-2.1" class="relref">Section 2.1</a></span>). If they have a valid ACT credential for the designated
Issuer, Clients can use the TokenChallenge to produce a single token for
presentation. Otherwise, Clients invoke the issuance protocol to obtain an
ACT credential. This interaction is shown below.<a href="#section-4-2" class="pilcrow">¶</a></p>
<span id="name-issuance-and-redemption-ove"></span><div id="fig-overview">
<figure id="figure-1">
        <div id="section-4-3.1">
          <div class="alignLeft art-svg artwork" id="section-4-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="288" width="544" viewBox="0 0 544 288" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,48 L 8,80" fill="none" stroke="black"></path>
              <path d="M 40,80 L 40,272" fill="none" stroke="black"></path>
              <path d="M 80,48 L 80,80" fill="none" stroke="black"></path>
              <path d="M 168,48 L 168,80" fill="none" stroke="black"></path>
              <path d="M 216,80 L 216,112" fill="none" stroke="black"></path>
              <path d="M 216,160 L 216,176" fill="none" stroke="black"></path>
              <path d="M 216,256 L 216,272" fill="none" stroke="black"></path>
              <path d="M 256,48 L 256,80" fill="none" stroke="black"></path>
              <path d="M 312,32 L 312,80" fill="none" stroke="black"></path>
              <path d="M 336,48 L 336,80" fill="none" stroke="black"></path>
              <path d="M 376,80 L 376,120" fill="none" stroke="black"></path>
              <path d="M 376,152 L 376,232" fill="none" stroke="black"></path>
              <path d="M 408,48 L 408,80" fill="none" stroke="black"></path>
              <path d="M 440,48 L 440,80" fill="none" stroke="black"></path>
              <path d="M 472,80 L 472,272" fill="none" stroke="black"></path>
              <path d="M 512,48 L 512,80" fill="none" stroke="black"></path>
              <path d="M 536,48 L 536,80" fill="none" stroke="black"></path>
              <path d="M 312,32 L 520,32" fill="none" stroke="black"></path>
              <path d="M 8,48 L 80,48" fill="none" stroke="black"></path>
              <path d="M 168,48 L 256,48" fill="none" stroke="black"></path>
              <path d="M 336,48 L 408,48" fill="none" stroke="black"></path>
              <path d="M 440,48 L 512,48" fill="none" stroke="black"></path>
              <path d="M 8,80 L 80,80" fill="none" stroke="black"></path>
              <path d="M 168,80 L 256,80" fill="none" stroke="black"></path>
              <path d="M 336,80 L 408,80" fill="none" stroke="black"></path>
              <path d="M 440,80 L 512,80" fill="none" stroke="black"></path>
              <path d="M 328,96 L 368,96" fill="none" stroke="black"></path>
              <path d="M 384,96 L 464,96" fill="none" stroke="black"></path>
              <path d="M 480,96 L 520,96" fill="none" stroke="black"></path>
              <path d="M 40,128 L 208,128" fill="none" stroke="black"></path>
              <path d="M 288,128 L 464,128" fill="none" stroke="black"></path>
              <path d="M 48,144 L 176,144" fill="none" stroke="black"></path>
              <path d="M 312,144 L 472,144" fill="none" stroke="black"></path>
              <path d="M 48,174 L 72,174" fill="none" stroke="black"></path>
              <path d="M 48,178 L 72,178" fill="none" stroke="black"></path>
              <path d="M 184,174 L 208,174" fill="none" stroke="black"></path>
              <path d="M 184,178 L 208,178" fill="none" stroke="black"></path>
              <path d="M 40,192 L 128,192" fill="none" stroke="black"></path>
              <path d="M 288,192 L 368,192" fill="none" stroke="black"></path>
              <path d="M 48,208 L 128,208" fill="none" stroke="black"></path>
              <path d="M 296,208 L 376,208" fill="none" stroke="black"></path>
              <path d="M 40,240 L 128,240" fill="none" stroke="black"></path>
              <path d="M 272,240 L 464,240" fill="none" stroke="black"></path>
              <path d="M 48,256 L 128,256" fill="none" stroke="black"></path>
              <path d="M 328,256 L 472,256" fill="none" stroke="black"></path>
              <path d="M 520,32 C 528.83064,32 536,39.16936 536,48" fill="none" stroke="black"></path>
              <path d="M 328,96 C 319.16936,96 312,88.83064 312,80" fill="none" stroke="black"></path>
              <path d="M 520,96 C 528.83064,96 536,88.83064 536,80" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="472,240 460,234.4 460,245.6" fill="black" transform="rotate(0,464,240)"></polygon>
              <polygon class="arrowhead" points="472,128 460,122.4 460,133.6" fill="black" transform="rotate(0,464,128)"></polygon>
              <polygon class="arrowhead" points="376,192 364,186.4 364,197.6" fill="black" transform="rotate(0,368,192)"></polygon>
              <polygon class="arrowhead" points="216,176 204,170.4 204,181.6" fill="black" transform="rotate(0,208,176)"></polygon>
              <polygon class="arrowhead" points="56,256 44,250.4 44,261.6" fill="black" transform="rotate(180,48,256)"></polygon>
              <polygon class="arrowhead" points="56,208 44,202.4 44,213.6" fill="black" transform="rotate(180,48,208)"></polygon>
              <polygon class="arrowhead" points="56,176 44,170.4 44,181.6" fill="black" transform="rotate(180,48,176)"></polygon>
              <polygon class="arrowhead" points="56,144 44,138.4 44,149.6" fill="black" transform="rotate(180,48,144)"></polygon>
              <g class="text">
                <text x="44" y="68">Client</text>
                <text x="212" y="68">Attester</text>
                <text x="372" y="68">Issuer</text>
                <text x="476" y="68">Origin</text>
                <text x="248" y="132">Request</text>
                <text x="244" y="148">TokenChallenge</text>
                <text x="128" y="180">Attestation</text>
                <text x="208" y="196">CredentialRequest</text>
                <text x="212" y="212">CredentialResponse</text>
                <text x="216" y="228">|</text>
                <text x="168" y="244">Request</text>
                <text x="208" y="244">+</text>
                <text x="240" y="244">Token</text>
                <text x="172" y="260">Response</text>
                <text x="272" y="260">TokenRefund</text>
                <text x="376" y="276">|</text>
              </g>
            </svg><a href="#section-4-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-issuance-and-redemption-ove" class="selfRef">Issuance and Redemption Overview</a>
        </figcaption></figure>
</div>
<p id="section-4-4">Similar to the core Privacy Pass protocols, the TokenChallenge can
be interactive or non-interactive, and per-origin or cross-origin.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">ACT is only compatible with deployment models where the Issuer and Origin
are operated by the same entity (see <span><a href="https://rfc-editor.org/rfc/rfc9576#section-4" class="relref">Section 4</a> of [<a href="#ARCHITECTURE" class="cite xref">ARCHITECTURE</a>]</span>), as
tokens produced from a credential are not publicly verifiable. The details
of attestation are outside the scope of the issuance protocol; see
<span><a href="https://rfc-editor.org/rfc/rfc9576#section-4" class="relref">Section 4</a> of [<a href="#ARCHITECTURE" class="cite xref">ARCHITECTURE</a>]</span> for information about how attestation can
be implemented in each of the relevant deployment models.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">The issuance and redemption protocols in this document are built on
<span>[<a href="#ACT" class="cite xref">ACT</a>]</span>.<a href="#section-4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="state-management">
<section id="section-5">
      <h2 id="name-client-state-management">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-client-state-management" class="section-name selfRef">Client State Management</a>
      </h2>
<div id="credential-lifecycle-and-distributed-transactions">
<section id="section-5.1">
        <h3 id="name-credential-lifecycle-and-di">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-credential-lifecycle-and-di" class="section-name selfRef">Credential Lifecycle and Distributed Transactions</a>
        </h3>
<p id="section-5.1-1">ACT credentials follow a distributed transaction model where each spend operation
creates a two-phase interaction between the client and the origin:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1-2">
<li id="section-5.1-2.1">
            <p id="section-5.1-2.1.1"><strong>Spend Phase</strong>: The client commits to spending a credential by generating a spend
proof containing a nullifier. At this point, the credential <span class="bcp14">MUST</span> be considered
invalid and cannot be reused.<a href="#section-5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.1-2.2">
            <p id="section-5.1-2.2.1"><strong>Refund Phase</strong>: The origin verifies the spend proof and, if valid, returns a
refund that allows the client to construct a new credential with the remaining
balance.<a href="#section-5.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-5.1-3">This two-phase model is critical for ACT's concurrency control properties. Because
a credential becomes invalid immediately upon spend (before the refund is received),
a client cannot perform multiple concurrent spend operations with the same credential.
This enforces a strict serialization of operations per credential chain.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-state-transitions">
<section id="section-5.2">
        <h3 id="name-client-state-transitions">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-client-state-transitions" class="section-name selfRef">Client State Transitions</a>
        </h3>
<p id="section-5.2-1">A client managing an ACT credential progresses through the following states:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="section-5.2-2">
          <div class="alignLeft art-svg artwork" id="section-5.2-2.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="288" width="440" viewBox="0 0 440 288" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
              <path d="M 8,128 L 8,160" fill="none" stroke="black"></path>
              <path d="M 8,224 L 8,256" fill="none" stroke="black"></path>
              <path d="M 48,64 L 48,120" fill="none" stroke="black"></path>
              <path d="M 48,160 L 48,216" fill="none" stroke="black"></path>
              <path d="M 96,32 L 96,64" fill="none" stroke="black"></path>
              <path d="M 96,128 L 96,160" fill="none" stroke="black"></path>
              <path d="M 96,224 L 96,256" fill="none" stroke="black"></path>
              <path d="M 8,32 L 96,32" fill="none" stroke="black"></path>
              <path d="M 8,64 L 96,64" fill="none" stroke="black"></path>
              <path d="M 8,128 L 96,128" fill="none" stroke="black"></path>
              <path d="M 8,160 L 96,160" fill="none" stroke="black"></path>
              <path d="M 8,224 L 96,224" fill="none" stroke="black"></path>
              <path d="M 8,256 L 96,256" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="56,216 44,210.4 44,221.6" fill="black" transform="rotate(90,48,216)"></polygon>
              <polygon class="arrowhead" points="56,120 44,114.4 44,125.6" fill="black" transform="rotate(90,48,120)"></polygon>
              <g class="text">
                <text x="56" y="52">Initial</text>
                <text x="160" y="52">(Credential</text>
                <text x="228" y="52">with</text>
                <text x="256" y="52">N</text>
                <text x="300" y="52">credits)</text>
                <text x="148" y="100">ProveSpend(credential,</text>
                <text x="264" y="100">cost)</text>
                <text x="56" y="148">Spent</text>
                <text x="148" y="148">(Waiting</text>
                <text x="200" y="148">for</text>
                <text x="248" y="148">refund,</text>
                <text x="324" y="148">credential</text>
                <text x="404" y="148">invalid)</text>
                <text x="172" y="196">ConstructRefundToken(refund)</text>
                <text x="52" y="244">Refunded</text>
                <text x="132" y="244">(New</text>
                <text x="196" y="244">credential</text>
                <text x="260" y="244">with</text>
                <text x="308" y="244">N-cost</text>
                <text x="372" y="244">credits)</text>
              </g>
            </svg><a href="#section-5.2-2.1" class="pilcrow">¶</a>
</div>
</div>
<p id="section-5.2-3">State transitions:<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-4.1">
            <p id="section-5.2-4.1.1"><strong>Initial</strong>: Client holds a valid credential with N credits (N &gt; 0). The credential
can be spent.<a href="#section-5.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-4.2">
            <p id="section-5.2-4.2.1"><strong>Spent</strong>: Client has generated a spend proof and sent it to the origin. The
original credential is now invalid and <span class="bcp14">MUST NOT</span> be used again. The client is
blocked waiting for a refund response.<a href="#section-5.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-4.3">
            <p id="section-5.2-4.3.1"><strong>Refunded</strong>: Client has received a valid refund and constructed a new credential
with the remaining balance. If the new balance is greater than 0, the client
returns to the Initial state with the new credential. If the balance is 0, the
credential is exhausted.<a href="#section-5.2-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.2-5">The transition from Spent to Refunded may fail if the origin does not provide a
valid refund. Error handling for this case is described in <a href="#error-handling" class="auto internal xref">Section 5.5</a>.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="concurrency-control-through-blocking">
<section id="section-5.3">
        <h3 id="name-concurrency-control-through">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-concurrency-control-through" class="section-name selfRef">Concurrency Control Through Blocking</a>
        </h3>
<p id="section-5.3-1">The key insight enabling ACT's concurrency control is that each credential instance
can only be in one state at a time. When a client calls ProveSpend, it must
immediately transition the credential to the Spent state, making it unavailable for
any other operations. The client cannot perform another spend until it receives a
refund and transitions to the Refunded state with a new credential instance.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">This blocking behavior prevents credential sharing and concurrent usage:<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-3.1">
            <p id="section-5.3-3.1.1">If a malicious party attempts to copy a credential and use it elsewhere, only one
spend operation can succeed (whichever reaches the origin first). The second spend
will be rejected as a double-spend when the origin checks the nullifier.<a href="#section-5.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-3.2">
            <p id="section-5.3-3.2.1">Even if a single client attempts to perform concurrent spends with the same
credential, the first spend invalidates the credential, preventing the second.<a href="#section-5.3-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.3-4">The origin can enforce session behavior by declining to issue a refund, effectively
terminating the credential chain and preventing further operations.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multiple-credential-management">
<section id="section-5.4">
        <h3 id="name-multiple-credential-managem">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-multiple-credential-managem" class="section-name selfRef">Multiple Credential Management</a>
        </h3>
<p id="section-5.4-1">Clients <span class="bcp14">MAY</span> maintain multiple independent credential chains simultaneously. This is
useful when credentials are bound to different contexts via the credential_context
field (<a href="#token-challenge-requirements" class="auto internal xref">Section 7</a>).<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">Example: A client might hold:<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-3.1">
            <p id="section-5.4-3.1.1">Credential A: Bound to issuer1.example, origin1.example, credential_context =
"session-2024-01", with 100 credits<a href="#section-5.4-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.4-3.2">
            <p id="section-5.4-3.2.1">Credential B: Bound to issuer1.example, origin2.example, credential_context =
"session-2024-01", with 50 credits<a href="#section-5.4-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.4-3.3">
            <p id="section-5.4-3.3.1">Credential C: Bound to issuer1.example, origin1.example, credential_context =
"session-2024-02", with 75 credits<a href="#section-5.4-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.4-4">Each credential chain operates independently with its own state machine. A spend
operation on Credential A does not affect Credentials B or C. The client can perform
spend operations on different credentials concurrently, but each individual credential
chain is strictly serialized through the spend-refund cycle.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<p id="section-5.4-5">When the client receives a <code>TokenChallenge</code>, it determines which credential to use
based on the challenge's <code>issuer_name</code>, <code>origin_info</code>, and <code>credential_context</code> fields.
If no matching credential exists or all matching credentials are in the <code>Spent</code> state
(awaiting refund), the client <span class="bcp14">SHOULD</span> either wait for a refund or request a new
credential through the issuance protocol.<a href="#section-5.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="error-handling">
<section id="section-5.5">
        <h3 id="name-error-handling">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-error-handling" class="section-name selfRef">Error Handling</a>
        </h3>
<div id="delayed-or-missing-refunds">
<section id="section-5.5.1">
          <h4 id="name-delayed-or-missing-refunds">
<a href="#section-5.5.1" class="section-number selfRef">5.5.1. </a><a href="#name-delayed-or-missing-refunds" class="section-name selfRef">Delayed or Missing Refunds</a>
          </h4>
<p id="section-5.5.1-1">After a client sends a spend proof to the origin, the client must wait for the
corresponding refund before it can continue using the credential chain. The spent
credential instance is immediately invalid and <span class="bcp14">MUST NOT</span> be reused.<a href="#section-5.5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.5.1-2">Origins <span class="bcp14">MAY</span> retain spend proof state and serve delayed refund requests after service
interruptions or failures. This allows credential chains to resume even if the initial
refund response was not delivered due to network issues or temporary service outages.<a href="#section-5.5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.5.1-3">However, origins <span class="bcp14">MAY</span> also implement a timeout after which they delete stored refund
state. If a client's refund request arrives after this timeout, the origin will be
unable to provide the refund, effectively terminating that credential chain. Clients
in this situation will need to request a new credential through the issuance protocol
(<a href="#credential-issuance-protocol" class="auto internal xref">Section 8</a>) to continue accessing the origin.<a href="#section-5.5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="setup">
<section id="section-6">
      <h2 id="name-configuration">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-configuration" class="section-name selfRef">Configuration</a>
      </h2>
<p id="section-6-1">ACT Issuers are configured with key material used for issuance and credential
verification. Concretely, Issuers run the <code>KeyGen</code> function from <span>[<a href="#ACT" class="cite xref">ACT</a>]</span>
to produce a private and public key, denoted skI and pkI, respectively.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-2">
<pre>
skI, pkI = KeyGen()
</pre><a href="#section-6-2" class="pilcrow">¶</a>
</div>
<p id="section-6-3">The Issuer Public Key ID, denoted <code>issuer_key_id</code>, is computed as the
SHA-256 hash of the Issuer Public Key, i.e., <code>issuer_key_id = SHA-256(pkI_serialized)</code>,
where <code>pkI_serialized</code> is the serialized version of <code>pkI</code> as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-schlesinger-cfrg-act-00#section-4.1" class="relref">Section 4.1</a> of [<a href="#ACT" class="cite xref">ACT</a>]</span>.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">OPEN ISSUE: Coordinate with <span>[<a href="#ACT" class="cite xref">ACT</a>]</span> specification authors on the serialization format (CBOR vs TLS presentation language) to ensure consistency.<a href="#section-6-4" class="pilcrow">¶</a></p>
<div id="request-context-extension">
<section id="section-6.1">
        <h3 id="name-request-context-extension">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-request-context-extension" class="section-name selfRef">Request Context Extension</a>
        </h3>
<p id="section-6.1-1">This Privacy Pass integration binds credentials to application-specific contexts
using a <code>request_context</code> parameter. This approach is inspired by the Anonymous
Rate-Limited Credentials (ARC) protocol <span>[<a href="#ARC_PP" class="cite xref">ARC_PP</a>]</span>, which threads a similar
context parameter through its cryptographic operations for domain separation.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">IMPORTANT: The current CFRG ACT specification <span>[<a href="#ACT" class="cite xref">ACT</a>]</span> does not include
<code>request_context</code> parameters in its cryptographic functions. To support the
Privacy Pass integration described in this document, the ACT specification would
need to be extended with the following changes:<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-3">
<li id="section-6.1-3.1">
            <p id="section-6.1-3.1.1"><strong>IssueRequest</strong>: No changes needed - the client generates a blinded commitment
without knowledge of the final context binding.<a href="#section-6.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.1-3.2">
            <p id="section-6.1-3.2.1"><strong>IssueResponse</strong>: Add <code>request_context</code> as an input parameter alongside the
credit amount <code>c</code>. The issuer determines the appropriate context based on its
policy (e.g., derived from TokenChallenge fields) and binds the credential to
this context. The function would hash the context into a scalar and include it
in the credential signature, similar to how ARC hashes <code>requestContext</code> into <code>m2</code>.<a href="#section-6.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.1-3.3">
            <p id="section-6.1-3.3.1"><strong>VerifyAndRefund</strong>: Add <code>request_context</code> as an input parameter to verify
that the spend proof is bound to the correct application context. The issuer
reconstructs the context from the TokenChallenge and uses it during verification.<a href="#section-6.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.1-3.4">
            <p id="section-6.1-3.4.1"><strong>Credential Structure</strong>: The Anonymous Credit Token structure would be extended
to include the context-bound component within the BBS signature, analogous to
how ARC credentials include <code>m2</code> for presentation context binding.<a href="#section-6.1-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-6.1-4">The key insight is that <code>request_context</code> is determined by the issuer (like the
credit amount), not by the client. The issuer sets the context during IssueResponse
based on the TokenChallenge requirements, and both parties reconstruct it from
TokenChallenge fields during spending.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">Until these extensions are incorporated into the CFRG ACT specification, the
function calls in this document should be understood as describing the intended
behavior with request_context support. Implementations <span class="bcp14">SHOULD</span> coordinate with
the CFRG ACT specification authors to ensure compatibility.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">For reference on how request context threading works in practice, see
<span><a href="https://datatracker.ietf.org/doc/html/draft-yun-cfrg-arc-01#section-3" class="relref">Section 3</a> of [<a href="#ARC_PP" class="cite xref">ARC_PP</a>]</span>, which demonstrates the pattern of binding credentials
to application-specific contexts through cryptographic commitments.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="token-challenge-requirements">
<section id="section-7">
      <h2 id="name-token-challenge-requirement">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-token-challenge-requirement" class="section-name selfRef">Token Challenge Requirements</a>
      </h2>
<p id="section-7-1">The ACT protocol uses a modified TokenChallenge structure from the one
specified in <span>[<a href="#AUTHSCHEME" class="cite xref">AUTHSCHEME</a>]</span>. In particular, the updated TokenChallenge
structure is as follows:<a href="#section-7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7-2">
<pre>
struct {
    uint16_t token_type = 0xE5AD; /* Type ACT(Ristretto255) */
    opaque issuer_name&lt;1..2^16-1&gt;;
    opaque redemption_context&lt;0..32&gt;;
    opaque origin_info&lt;0..2^16-1&gt;;
    opaque credential_context&lt;0..32&gt;;
} TokenChallenge;
</pre><a href="#section-7-2" class="pilcrow">¶</a>
</div>
<p id="section-7-3">OPEN ISSUE: This token type value (0xE5AD) was chosen arbitrarily and may be too close to the ARC token type. This should be coordinated with IANA registry assignments.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">With the exception of <code>credential_context</code>, all fields are exactly as specified
in <span><a href="https://rfc-editor.org/rfc/rfc9577#section-2.1.1" class="relref">Section 2.1.1</a> of [<a href="#AUTHSCHEME" class="cite xref">AUTHSCHEME</a>]</span>. The <code>credential_context</code> field is defined as
follows:<a href="#section-7-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-5.1">
          <p id="section-7-5.1.1">"credential_context" is a field that is either 0 or 32 bytes, prefixed with a single
octet indicating the length (either 0 or 32). If the value is non-empty, it is a 32-byte value
generated by the origin that allows the origin to require that clients fetch credentials
bound to a specific context. Challenges with credential_context values of invalid lengths
<span class="bcp14">MUST</span> be rejected.<a href="#section-7-5.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-6">Similar to the <code>redemption_context</code> field, the <code>credential_context</code> is used to bind
information to the credential. This might be useful, for example, to enforce some
expiration on the credential. Origins might do this by constructing <code>credential_context</code>
as F(current time window), where F is a pseudorandom function. Semantically, this is
equivalent to the Origin asking the Client for a token from a credential that is
bound to "current time window."<a href="#section-7-6" class="pilcrow">¶</a></p>
<p id="section-7-7">OPEN ISSUE: give more guidance about how to construct credential_context and redemption_context depending on the application's needs.<a href="#section-7-7" class="pilcrow">¶</a></p>
<p id="section-7-8">In addition to this updated TokenChallenge, the HTTP authentication challenge
also <span class="bcp14">SHOULD</span> contain the following additional attribute:<a href="#section-7-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-9.1">
          <p id="section-7-9.1.1">"cost", which contains a JSON number indicating the amount of credits to
spend out of the ACT credential.<a href="#section-7-9.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-10">Implementation-specific steps: the client should store the Origin-provided input <code>tokenChallenge</code> so that when they receive a new <code>tokenChallenge</code> value, they can check if it has changed and which fields are different. This will inform the client's behavior - for example, if <code>credential_context</code> is being used to enforce an expiration on the credential, then if the <code>credential_context</code> has changed, this can prompt the client to request a new credential.<a href="#section-7-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-issuance-protocol">
<section id="section-8">
      <h2 id="name-credential-issuance-protoco">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-credential-issuance-protoco" class="section-name selfRef">Credential Issuance Protocol</a>
      </h2>
<p id="section-8-1">Issuers provide an Issuer Private and Public Key, denoted <code>skI</code> and <code>pkI</code>
respectively, used to produce credentials as input to the protocol. See <a href="#setup" class="auto internal xref">Section 6</a>
for how these keys are generated.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Clients provide the following as input to the issuance protocol:<a href="#section-8-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-3.1">
          <p id="section-8-3.1.1">Issuer Request URL: A URL identifying the location to which issuance requests
are sent. This can be a URL derived from the "issuer-request-uri" value in the
Issuer's directory resource, or it can be another Client-configured URL. The value
of this parameter depends on the Client configuration and deployment model.
For example, in the 'Joint Origin and Issuer' deployment model, the Issuer
Request URL might correspond to the Client's configured Attester, and the
Attester is configured to relay requests to the Issuer.<a href="#section-8-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-3.2">
          <p id="section-8-3.2.1">Issuer name: An identifier for the Issuer. This is typically a host name that
can be used to construct HTTP requests to the Issuer.<a href="#section-8-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-3.3">
          <p id="section-8-3.3.1">Issuer Public Key: <code>pkI</code>, with a key identifier <code>token_key_id</code> computed as
described in <a href="#setup" class="auto internal xref">Section 6</a>.<a href="#section-8-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-4">Given this configuration and these inputs, the two messages exchanged in
this protocol to produce a credential are described below.<a href="#section-8-4" class="pilcrow">¶</a></p>
<div id="client-to-issuer-request">
<section id="section-8.1">
        <h3 id="name-client-to-issuer-request">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-client-to-issuer-request" class="section-name selfRef">Client-to-Issuer Request</a>
        </h3>
<p id="section-8.1-1">Given Origin-provided input <code>tokenChallenge</code> and the Issuer Public Key ID <code>issuer_key_id</code>,
the Client first creates a credential request message using the <code>IssueRequest</code>
function from <span>[<a href="#ACT" class="cite xref">ACT</a>]</span> as follows:<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.1-2">
<pre>
(clientSecrets, request) = IssueRequest()
</pre><a href="#section-8.1-2" class="pilcrow">¶</a>
</div>
<p id="section-8.1-3">The Client then creates a TokenRequest structure as follows:<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.1-4">
<pre>
struct {
  uint16_t token_type = 0xE5AD; /* Type ACT(Ristretto255) */
  uint8_t truncated_issuer_key_id;
  uint8_t encoded_request[Nrequest];
} TokenRequest;
</pre><a href="#section-8.1-4" class="pilcrow">¶</a>
</div>
<p id="section-8.1-5">The structure fields are defined as follows:<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-6.1">
            <p id="section-8.1-6.1.1">"token_type" is a 2-octet integer.<a href="#section-8.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-6.2">
            <p id="section-8.1-6.2.1">"truncated_issuer_key_id" is the least significant byte of the <code>issuer_key_id</code>
(<a href="#setup" class="auto internal xref">Section 6</a>) in network byte order (in other words, the last 8
bits of <code>issuer_key_id</code>). This value is truncated so that Issuers cannot use
<code>issuer_key_id</code> as a way of uniquely identifying Clients; see <a href="#security" class="auto internal xref">Section 10</a>
and referenced information for more details.<a href="#section-8.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-6.3">
            <p id="section-8.1-6.3.1">"encoded_request" is the Nrequest-octet request, computed as the serialization
of the <code>request</code> value as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-schlesinger-cfrg-act-00#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#ACT" class="cite xref">ACT</a>]</span>.<a href="#section-8.1-6.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-7">The Client then generates an HTTP POST request to send to the Issuer Request URL,
with the TokenRequest as the content. The media type for this request is
"application/private-credential-request". An example request for the Issuer Request URL
"https://issuer.example.net/request" is shown below.<a href="#section-8.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.1-8">
<pre>
POST /request HTTP/1.1
Host: issuer.example.net
Accept: application/private-credential-response
Content-Type: application/private-credential-request
Content-Length: &lt;Length of TokenRequest&gt;

&lt;Bytes containing the TokenRequest&gt;
</pre><a href="#section-8.1-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="issuer-to-client-response">
<section id="section-8.2">
        <h3 id="name-issuer-to-client-response">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-issuer-to-client-response" class="section-name selfRef">Issuer-to-Client Response</a>
        </h3>
<p id="section-8.2-1">Upon receipt of the request, the Issuer validates the following conditions:<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-2.1">
            <p id="section-8.2-2.1.1">The TokenRequest contains a supported token_type equal to value 0xE5AD.<a href="#section-8.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-2.2">
            <p id="section-8.2-2.2.1">The TokenRequest.truncated_token_key_id corresponds to the truncated key ID
of an Issuer Public Key, with corresponding secret key <code>skI</code>, owned by
the Issuer.<a href="#section-8.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-2.3">
            <p id="section-8.2-2.3.1">The TokenRequest.encoded_request is of the correct size (<code>Nrequest</code>).<a href="#section-8.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.2-3">If any of these conditions is not met, the Issuer <span class="bcp14">MUST</span> return an HTTP 422
(Unprocessable Content) error to the client.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">If these conditions are met, the Issuer then tries to deserialize
TokenRequest.encoded_request according to <span><a href="https://datatracker.ietf.org/doc/html/draft-schlesinger-cfrg-act-00#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#ACT" class="cite xref">ACT</a>]</span>, yielding <code>request</code>.
If this fails, the Issuer <span class="bcp14">MUST</span> return an HTTP 422 (Unprocessable Content)
error to the client. Otherwise, if the Issuer is willing to produce a credential
for the Client, the Issuer determines both the number of initial credits and the
request_context based on its policy (e.g., based on attestation results, payment
verification, or TokenChallenge requirements). The request_context binds the
credential to the specific application context:<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.2-5">
<pre>
request_context = concat(tokenChallenge.issuer_name,
  tokenChallenge.origin_info,
  tokenChallenge.credential_context,
  issuer_key_id)
response = IssueResponse(skI, request, initial_credits, request_context)
</pre><a href="#section-8.2-5" class="pilcrow">¶</a>
</div>
<p id="section-8.2-6">The Issuer then creates a TokenResponse structured as follows:<a href="#section-8.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.2-7">
<pre>
struct {
   uint8_t encoded_response[Nresponse];
} TokenResponse;
</pre><a href="#section-8.2-7" class="pilcrow">¶</a>
</div>
<p id="section-8.2-8">The structure fields are defined as follows:<a href="#section-8.2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-9.1">
            <p id="section-8.2-9.1.1">"encoded_response" is the Nresponse-octet encoded issuance response message, computed
as the serialization of <code>response</code> as specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-schlesinger-cfrg-act-00#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#ACT" class="cite xref">ACT</a>]</span>.<a href="#section-8.2-9.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.2-10">The Issuer generates an HTTP response with status code 200 whose content
consists of TokenResponse, with the content type set as
"application/private-credential-response".<a href="#section-8.2-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.2-11">
<pre>
HTTP/1.1 200 OK
Content-Type: application/private-credential-response
Content-Length: &lt;Length of TokenResponse&gt;

&lt;Bytes containing the TokenResponse&gt;
</pre><a href="#section-8.2-11" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="credential-finalization">
<section id="section-8.3">
        <h3 id="name-credential-finalization">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-credential-finalization" class="section-name selfRef">Credential Finalization</a>
        </h3>
<p id="section-8.3-1">Upon receipt, the Client handles the response and, if successful, deserializes
the content values <code>TokenResponse.encoded_response</code> according to <span><a href="https://datatracker.ietf.org/doc/html/draft-schlesinger-cfrg-act-00#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#ACT" class="cite xref">ACT</a>]</span>
yielding <code>response</code>. If deserialization fails, the Client aborts the protocol.
Otherwise, the Client processes the response as follows:<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-2">
<pre>
credential = VerifyIssuance(pkI, request, response, clientSecrets)
</pre><a href="#section-8.3-2" class="pilcrow">¶</a>
</div>
<p id="section-8.3-3">The Client then saves the credential structure, associated with the given Issuer
Name, to use when producing Token values in response to future token challenges.<a href="#section-8.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="token-redemption-protocol">
<section id="section-9">
      <h2 id="name-token-redemption-protocol">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-token-redemption-protocol" class="section-name selfRef">Token Redemption Protocol</a>
      </h2>
<p id="section-9-1">The token redemption protocol takes as input TokenChallenge and cost
values from <span>[<a href="#AUTHSCHEME" class="cite xref">AUTHSCHEME</a>], <a href="https://rfc-editor.org/rfc/rfc9577#section-2.1" class="relref">Section 2.1</a></span>; the cost is sent as an additional
attribute within the HTTP challenge as described in <a href="#token-challenge-requirements" class="auto internal xref">Section 7</a>.
Clients use credentials from the issuance protocol in producing tokens
bound to the TokenChallenge. The process for producing a token in this
way, as well as verifying a resulting token, is described in the following sections.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="token-creation">
<section id="section-9.1">
        <h3 id="name-token-creation">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-token-creation" class="section-name selfRef">Token Creation</a>
        </h3>
<p id="section-9.1-1">Given a TokenChallenge value as input, denoted <code>challenge</code>, a cost,
denoted <code>cost</code>, and a previously obtained credential that is valid
for the Issuer identifier in the challenge, denoted <code>credential</code>, containing at
least <code>cost</code> credits, Clients compute a spend request as follows:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.1-2">
<pre>
spend_proof, state = ProveSpend(credential, cost)
</pre><a href="#section-9.1-2" class="pilcrow">¶</a>
</div>
<p id="section-9.1-3">Each credential instance <span class="bcp14">MUST</span> only ever be used for a single spend request. When the client
receives the refunded credential from the server, the client uses that new credential instance
for the next spend. If the same credential instance is used more than once, the privacy
assumptions of ACT are violated by presenting the same nullifier twice.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<p id="section-9.1-4">The resulting Token value is then constructed as follows:<a href="#section-9.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.1-5">
<pre>
struct {
    uint16_t token_type = 0xE5AD; /* Type ACT(Ristretto255) */
    uint8_t challenge_digest[32];
    uint8_t issuer_key_id[Nid];
    uint8_t encoded_spend_proof[Nspend_proof];
} Token;
</pre><a href="#section-9.1-5" class="pilcrow">¶</a>
</div>
<p id="section-9.1-6">The structure fields are defined as follows:<a href="#section-9.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-7.1">
            <p id="section-9.1-7.1.1">"token_type" is a 2-octet integer, in network byte order, equal to 0xE5AD.<a href="#section-9.1-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-7.2">
            <p id="section-9.1-7.2.1">"challenge_digest" is a 32-octet value containing the hash of the original TokenChallenge, SHA-256(TokenChallenge).<a href="#section-9.1-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-7.3">
            <p id="section-9.1-7.3.1">"issuer_key_id" is a Nid-octet identifier for the Issuer Public Key, computed
as defined in <a href="#setup" class="auto internal xref">Section 6</a>.<a href="#section-9.1-7.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-7.4">
            <p id="section-9.1-7.4.1">"encoded_spend_proof" is a Nspend_proof-octet encoded spend proof, set to the serialized
<code>spend_proof</code> value as specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-schlesinger-cfrg-act-00#section-4.1.3" class="relref">Section 4.1.3</a> of [<a href="#ACT" class="cite xref">ACT</a>]</span>. The spend proof contains
the nullifier (field 1) and spend amount (field 2), among other cryptographic values.<a href="#section-9.1-7.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="refund">
<section id="section-9.2">
        <h3 id="name-token-refund">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-token-refund" class="section-name selfRef">Token Refund</a>
        </h3>
<p id="section-9.2-1">Upon receiving a Token from the Client, the Origin deserializes the spend_proof
according to <span><a href="https://datatracker.ietf.org/doc/html/draft-schlesinger-cfrg-act-00#section-4.1.3" class="relref">Section 4.1.3</a> of [<a href="#ACT" class="cite xref">ACT</a>]</span>, yielding a SpendProofMsg structure. The
Origin then extracts the relevant fields from the spend proof:<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2-2">
<pre>
// Extract fields from SpendProofMsg (see Section 4.1.3 of ACT)
nullifier = spend_proof.k      // Field 1: nullifier (32 bytes)
spend_amount = spend_proof.s   // Field 2: spend amount (32 bytes)
</pre><a href="#section-9.2-2" class="pilcrow">¶</a>
</div>
<p id="section-9.2-3">The Origin <span class="bcp14">SHOULD</span> verify that the spend_amount matches the requested cost from
TokenChallenge to ensure the client is spending the expected amount.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2-4">To verify the Token and issue a refund, the Origin constructs the request_context
and invokes VerifyAndRefund:<a href="#section-9.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2-5">
<pre>
request_context = concat(tokenChallenge.issuer_name,
  tokenChallenge.origin_info,
  tokenChallenge.credential_context,
  issuer_key_id)
refund = VerifyAndRefund(skI, request_context, spend_proof)
</pre><a href="#section-9.2-5" class="pilcrow">¶</a>
</div>
<p id="section-9.2-6">This function returns the <code>refund</code> serialized according to <span><a href="https://datatracker.ietf.org/doc/html/draft-schlesinger-cfrg-act-00#section-4.1.4" class="relref">Section 4.1.4</a> of [<a href="#ACT" class="cite xref">ACT</a>]</span> if the spend proof is valid, and nil otherwise.<a href="#section-9.2-6" class="pilcrow">¶</a></p>
<p id="section-9.2-7">As mentioned in <span><a href="https://rfc-editor.org/rfc/rfc9577#section-2.2.2" class="relref">Section 2.2.2</a> of [<a href="#AUTHSCHEME" class="cite xref">AUTHSCHEME</a>]</span>, Origins <span class="bcp14">SHOULD</span> implement some form of double-spend prevention that prevents a token with the same nonce from being redeemed twice.
With ACT, the Origin <span class="bcp14">SHOULD</span> check that the nullifier has not previously been seen before calling VerifyAndRefund. It then stores the nullifier
for  use in future double-spending checks.
To reduce the overhead of performing double spend checks, the Origin <span class="bcp14">MAY</span> store and
look up the nullifiers corresponding to the associated request_context value.<a href="#section-9.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.2-8">
<pre>
struct {
    uint8_t refund[Nrefund];
} Refund;
</pre><a href="#section-9.2-8" class="pilcrow">¶</a>
</div>
<p id="section-9.2-9">The Origin sends the refund back to the client encoded as the above <code>Refund</code> struct.<a href="#section-9.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="new-credential-from-refund">
<section id="section-9.3">
        <h3 id="name-new-credential-from-refund">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-new-credential-from-refund" class="section-name selfRef">New Credential from Refund</a>
        </h3>
<p id="section-9.3-1">Unlike <span>[<a href="#ARC" class="cite xref">ARC</a>]</span>, clients must construct a new credential instance based on the <code>Refund</code> response. To do
so, clients invoke the <code>ConstructRefundToken</code> function from <span><a href="https://datatracker.ietf.org/doc/html/draft-schlesinger-cfrg-act-00#section-3.3.4" class="relref">Section 3.3.4</a> of [<a href="#ACT" class="cite xref">ACT</a>]</span> as follows:<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.3-2">
<pre>
credential = ConstructRefundToken(pkI, spend_proof, refund, state)
</pre><a href="#section-9.3-2" class="pilcrow">¶</a>
</div>
<p id="section-9.3-3">The client then uses this new credential instance for subsequent spend operations.<a href="#section-9.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="privacy-properties">
<section id="section-10.1">
        <h3 id="name-privacy-properties">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-privacy-properties" class="section-name selfRef">Privacy Properties</a>
        </h3>
<p id="section-10.1-1">Privacy considerations for tokens based on deployment details, such as issuer configuration
and issuer selection, are discussed in <span><a href="https://rfc-editor.org/rfc/rfc9576#section-6.1" class="relref">Section 6.1</a> of [<a href="#ARCHITECTURE" class="cite xref">ARCHITECTURE</a>]</span>. Note that ACT
requires a joint Origin and Issuer configuration (where the Issuer and Origin are operated
by the same entity) given that tokens produced from credentials are not publicly verifiable.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">ACT credentials offer Origin-Client unlinkability, Issuer-Client unlinkability, and
redemption context unlinkability, as described in <span><a href="https://rfc-editor.org/rfc/rfc9576#section-3.3" class="relref">Section 3.3</a> of [<a href="#ARCHITECTURE" class="cite xref">ARCHITECTURE</a>]</span>. The
cryptographic security properties of the underlying ACT protocol, including unforgeability
and unlinkability guarantees, are analyzed in <span>[<a href="#ACT" class="cite xref">ACT</a>]</span>.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="double-spend-prevention">
<section id="section-10.2">
        <h3 id="name-double-spend-prevention">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-double-spend-prevention" class="section-name selfRef">Double-Spend Prevention</a>
        </h3>
<p id="section-10.2-1"><span><a href="https://rfc-editor.org/rfc/rfc9577#section-2.2.2" class="relref">Section 2.2.2</a> of [<a href="#AUTHSCHEME" class="cite xref">AUTHSCHEME</a>]</span> specifies double spending requirements that Origin <span class="bcp14">SHOULD</span>
follow.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">For ACT, the double-spend prevention mechanism relies on Origins maintaining
state to track nullifiers. As described in <a href="#refund" class="auto internal xref">Section 9.2</a>, Origins <span class="bcp14">SHOULD</span> check that a nullifier
has not been previously seen before accepting a spend proof. This check is critical for
preventing credential reuse attacks.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
<p id="section-10.2-3">The nullifier space is large (32 bytes), making random collisions computationally
unlikely. However, Origins <span class="bcp14">SHOULD</span> ensure that their nullifier storage is persistent and
survives server restarts. If an Origin loses nullifier state (e.g., due to data loss or
cache eviction), it becomes vulnerable to replay attacks where an attacker can resubmit
previously spent credentials during the credential validity period.<a href="#section-10.2-3" class="pilcrow">¶</a></p>
<p id="section-10.2-4">Origins <span class="bcp14">MAY</span> scope nullifier storage by request_context to improve lookup performance
and enable efficient storage management. Since nullifiers are only meaningful within the
context of a specific credential binding (determined by <code>issuer_name</code>, <code>origin_info</code>,
<code>credential_context</code>, and <code>issuer_key_id</code>), Origins can partition nullifier storage accordingly.<a href="#section-10.2-4" class="pilcrow">¶</a></p>
<p id="section-10.2-5">When an Origin implements a timeout for refund state (as described in <a href="#error-handling" class="auto internal xref">Section 5.5</a>),
it <span class="bcp14">MAY</span> also expire the corresponding nullifier after the same timeout period, provided
that no future spend attempts with that nullifier are possible.<a href="#section-10.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="concurrency-control-and-credential-sharing">
<section id="section-10.3">
        <h3 id="name-concurrency-control-and-cre">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-concurrency-control-and-cre" class="section-name selfRef">Concurrency Control and Credential Sharing</a>
        </h3>
<p id="section-10.3-1">The state machine described in <a href="#state-management" class="auto internal xref">Section 5</a> enforces that each credential instance
can only be spent once. This prevents multiple parties from using the same credential
concurrently, which is critical for preventing credential sharing attacks.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<p id="section-10.3-2">If an attacker copies a credential and attempts to use it from multiple locations
simultaneously, only the first spend operation to reach the Origin will succeed. The
Origin's nullifier check will reject all subsequent spends with the same credential as
double-spend attempts. This property holds even if the spend operations occur in parallel
from different network locations.<a href="#section-10.3-2" class="pilcrow">¶</a></p>
<p id="section-10.3-3">Clients <span class="bcp14">MUST</span> implement the state machine correctly and transition credentials to the Spent
state immediately upon calling ProveSpend. A client implementation that allows multiple
concurrent ProveSpend calls on the same credential would enable double-spend attempts and
violate ACT's privacy guarantees by revealing that the same credential is being used
multiple times.<a href="#section-10.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-key-identification">
<section id="section-10.4">
        <h3 id="name-issuer-key-identification">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-issuer-key-identification" class="section-name selfRef">Issuer Key Identification</a>
        </h3>
<p id="section-10.4-1">As described in <a href="#credential-issuance-protocol" class="auto internal xref">Section 8</a>, the TokenRequest includes only a
truncated issuer_key_id (the least significant byte) to prevent Issuers from using the
key identifier as a client tracking mechanism.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<p id="section-10.4-2">Issuers <span class="bcp14">MUST</span> prevent truncated key ID collisions among simultaneously active keys. This
can be accomplished by generating keys until the truncated key ID does not collide with
any existing active key's truncated ID. With a 1-byte (256 value) truncated key space,
this is straightforward for reasonable numbers of concurrent keys.<a href="#section-10.4-2" class="pilcrow">¶</a></p>
<p id="section-10.4-3">Additionally, Issuers <span class="bcp14">SHOULD</span> limit the total number of simultaneously active keys for
privacy reasons, as a large number of active keys can enable partitioning attacks.<a href="#section-10.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dynamic-revocation-and-origin-control">
<section id="section-10.5">
        <h3 id="name-dynamic-revocation-and-orig">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-dynamic-revocation-and-orig" class="section-name selfRef">Dynamic Revocation and Origin Control</a>
        </h3>
<p id="section-10.5-1">ACT's design allows Origins to terminate credential chains by declining to issue refunds.
While this enables the dynamic revocation property described in <a href="#motivation" class="auto internal xref">Section 2</a>, it also
gives Origins significant control over client access.<a href="#section-10.5-1" class="pilcrow">¶</a></p>
<p id="section-10.5-2">Clients have no cryptographic recourse if an Origin refuses to provide refunds after
accepting valid spend proofs. This is an intentional design property that enables Origins
to enforce access policies and shed abusive traffic, but it does mean that clients must
trust Origins to behave correctly within the protocol.<a href="#section-10.5-2" class="pilcrow">¶</a></p>
<p id="section-10.5-3">Clients <span class="bcp14">MAY</span> implement reputation systems or other mechanisms to track Origin behavior and
avoid Origins that consistently fail to provide refunds. However, such mechanisms are
outside the scope of this specification.<a href="#section-10.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-11-1">This document updates the "Privacy Pass Token Type" Registry with the
following entries.<a href="#section-11-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-2.1">
          <p id="section-11-2.1.1">Value: 0xE5AD<a href="#section-11-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.2">
          <p id="section-11-2.2.1">Name: ACT (Ristretto255)<a href="#section-11-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.3">
          <p id="section-11-2.3.1">Token Structure: As defined in <span><a href="https://rfc-editor.org/rfc/rfc9577#section-2.2" class="relref">Section 2.2</a> of [<a href="#AUTHSCHEME" class="cite xref">AUTHSCHEME</a>]</span><a href="#section-11-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.4">
          <p id="section-11-2.4.1">Token Key Encoding: Serialized as described in <a href="#setup" class="auto internal xref">Section 6</a><a href="#section-11-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.5">
          <p id="section-11-2.5.1">TokenChallenge Structure: As defined in <span><a href="https://rfc-editor.org/rfc/rfc9577#section-2.1" class="relref">Section 2.1</a> of [<a href="#AUTHSCHEME" class="cite xref">AUTHSCHEME</a>]</span><a href="#section-11-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.6">
          <p id="section-11-2.6.1">Public Verifiability: N<a href="#section-11-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.7">
          <p id="section-11-2.7.1">Public Metadata: N<a href="#section-11-2.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.8">
          <p id="section-11-2.8.1">Private Metadata: N<a href="#section-11-2.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.9">
          <p id="section-11-2.9.1">Nk: 0 (not applicable)<a href="#section-11-2.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.10">
          <p id="section-11-2.10.1">Nid: 32<a href="#section-11-2.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.11">
          <p id="section-11-2.11.1">Reference: This document<a href="#section-11-2.11.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-2.12">
          <p id="section-11-2.12.1">Notes: None<a href="#section-11-2.12.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec-normative-references">
<section id="section-12">
      <h2 id="name-normative-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="ACT">[ACT]</dt>
      <dd>
<span class="refAuthor">Schlesinger, S.</span> and <span class="refAuthor">J. Katz</span>, <span class="refTitle">"Anonymous Credit Tokens"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-schlesinger-cfrg-act-00</span>, <time datetime="2025-08-18" class="refDate">18 August 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-schlesinger-cfrg-act-00">https://datatracker.ietf.org/doc/html/draft-schlesinger-cfrg-act-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ARC">[ARC]</dt>
      <dd>
<span class="refAuthor">Yun, C.</span> and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Privacy Pass Issuance Protocol for Anonymous Rate-Limited Credentials"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-yun-privacypass-arc-01</span>, <time datetime="2025-08-06" class="refDate">6 August 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-yun-privacypass-arc-01">https://datatracker.ietf.org/doc/html/draft-yun-privacypass-arc-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ARCHITECTURE">[ARCHITECTURE]</dt>
      <dd>
<span class="refAuthor">Davidson, A.</span>, <span class="refAuthor">Iyengar, J.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"The Privacy Pass Architecture"</span>, <span class="seriesInfo">RFC 9576</span>, <span class="seriesInfo">DOI 10.17487/RFC9576</span>, <time datetime="2024-06" class="refDate">June 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9576">https://www.rfc-editor.org/rfc/rfc9576</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ARC_PP">[ARC_PP]</dt>
      <dd>
<span class="refAuthor">Yun, C.</span> and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Anonymous Rate-Limited Credentials"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-yun-cfrg-arc-01</span>, <time datetime="2025-08-06" class="refDate">6 August 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-yun-cfrg-arc-01">https://datatracker.ietf.org/doc/html/draft-yun-cfrg-arc-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="AUTHSCHEME">[AUTHSCHEME]</dt>
      <dd>
<span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Valdez, S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"The Privacy Pass HTTP Authentication Scheme"</span>, <span class="seriesInfo">RFC 9577</span>, <span class="seriesInfo">DOI 10.17487/RFC9577</span>, <time datetime="2024-06" class="refDate">June 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9577">https://www.rfc-editor.org/rfc/rfc9577</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISSUANCE">[ISSUANCE]</dt>
      <dd>
<span class="refAuthor">Celi, S.</span>, <span class="refAuthor">Davidson, A.</span>, <span class="refAuthor">Valdez, S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Privacy Pass Issuance Protocols"</span>, <span class="seriesInfo">RFC 9578</span>, <span class="seriesInfo">DOI 10.17487/RFC9578</span>, <time datetime="2024-06" class="refDate">June 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9578">https://www.rfc-editor.org/rfc/rfc9578</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS13">[TLS13]</dt>
    <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">The authors would like to thank Cathie Yun, Thibault Meunier, and Chris Wood.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Samuel Schlesinger</span></div>
<div dir="auto" class="left"><span class="org">Google</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:samschlesinger@google.com" class="email">samschlesinger@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thibault Meunier</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ot-ietf@thibault.uk" class="email">ot-ietf@thibault.uk</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
